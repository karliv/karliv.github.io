{"version":3,"file":"218.build.7b4c03c2abb2fb294164.js","sources":["webpack:///webpack:///../src/views/User/EmptyEmail/Index.vue","webpack:///webpack:///Index.vue","webpack:///webpack:///../src/views/User/EmptyEmail/Index.vue?4b92"],"sourcesContent":["var disposed = false\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-25f5c3e8\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\nComponent.options.__file = \"src/views/User/EmptyEmail/Index.vue\"\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-25f5c3e8\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-25f5c3e8\", Component.options)\n  }\n  module.hot.dispose(function (data) {\n    disposed = true\n  })\n})()}\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../src/views/User/EmptyEmail/Index.vue\n// module id = 1418\n// module chunks = 218\n\n\n// WEBPACK FOOTER //\n// webpack:///../src/views/User/EmptyEmail/Index.vue","<template>\n  <div class=\"lm-m-register-page\">\n    <div class=\"wrapper lm-m-register-page-wrapper\">\n      <div class=\"lm-m-register-wrap-form\">\n        <h2 class=\"heading heading_h2 mb_9\">Необходимо ввести email</h2>\n        <div class=\"lm-input-wrap\">\n          <input type=\"email\"\n                 tabindex=\"1\"\n                 name=\"email\"\n                 autocapitalize=off\n                 placeholder=\"E-mail\"\n                 :class=\"[{ 'error': (verrors.has('email')), 'ok': isValidEmail }, 'lm-input']\"\n                 v-validate=\"'required|email'\"\n                 v-model=\"fields.email\">\n          <span class=\"lm-input-error\" v-if=\"verrors.has('email')\">{{ verrors.first('email')}}</span>\n        </div>\n\n        <div>\n          <button @click=\"saveEmail\" href=\"javascript:void(0)\"\n                  :class=\"['lm-primary-button', { 'disabled': (this.verrors.any() || !fields.email) }]\">Продолжить\n          </button>\n        </div>\n      </div>\n      <div></div>\n    </div>\n  </div>\n</template>\n\n<script>\n  import { mapGetters } from 'vuex'\n  import { Toast, Indicator } from 'mint-ui'\n\n  export default {\n    metaInfo: {\n      title: 'Подтверждение email',\n    },\n    data () {\n      return {\n        loading: false,\n        error: false,\n        success: false,\n        fields: {\n          email: null\n        }\n      }\n    },\n    computed: {\n      ...mapGetters({\n        user: 'auth/getAuthUser',\n      }),\n      isValidEmail () {\n        return (this.vfields && this.vfields.hasOwnProperty('email') && this.vfields.email.valid)\n      },\n    },\n    methods: {\n      _handleValidateFields () {\n        return new Promise((resolve, reject) => {\n          this.$validator.validateAll().then(result => {\n            if (result) {\n              resolve(result)\n            } else reject()\n          })\n        })\n      },\n      saveEmail () {\n        this._handleValidateFields().then(result => {\n          if (result) {\n            if (this.loading) return\n\n            Indicator.open()\n            this.loading = true\n\n            this.$api.post('/api/v1/users/email', this.fields).then((response) => {\n              Indicator.close()\n              this.loading = false\n\n              Toast({\n                message: 'Успешно',\n                iconClass: 'mintui mintui-success'\n              })\n\n              this.$store.dispatch('auth/setHasEmail', true)\n\n              let { username } = this.user\n\n              this.$router.push({ name: 'user.show', params: { username } })\n            }, (error) => {\n              Indicator.close()\n\n              Toast({\n                message: 'Ошибка',\n                iconClass: 'mintui mintui-field-error'\n              })\n\n              this.loading = false\n\n              const { response: { data }, response: { status } } = error\n\n              if (status === 422) {\n                this.$setLaravelValidationErrorsFromResponse(data)\n              } else throw new Error('Error attach email')\n            })\n          }\n        })\n      },\n      recovery () {\n        return new Promise((resolve, reject) => {\n          Indicator.open()\n\n          this.loading = true\n\n          const { email } = this.fields\n\n          this.$api.post('api/v1/auth/recovery', { email }).then((response) => {\n            Indicator.close()\n            this.loading = false\n\n            Toast({\n              message: 'Успешно',\n              iconClass: 'mintui mintui-success'\n            })\n\n            const { data } = response\n\n            resolve(data)\n\n          }, (error) => {\n            Indicator.close()\n\n            Toast({\n              message: 'Ошибка',\n              iconClass: 'mintui mintui-field-error'\n            })\n\n            this.loading = false\n\n            const { response: { data }, response: { status } } = error\n\n            if (status === 422) {\n              this.$setLaravelValidationErrorsFromResponse(data)\n            } else throw new Error('Error recovery password')\n\n            reject(data)\n          })\n        })\n\n      }\n    }\n  }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// Index.vue\n\n\n// WEBPACK FOOTER //\n// webpack:///Index.vue","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"div\", { staticClass: \"lm-m-register-page\" }, [\n    _c(\"div\", { staticClass: \"wrapper lm-m-register-page-wrapper\" }, [\n      _c(\"div\", { staticClass: \"lm-m-register-wrap-form\" }, [\n        _c(\"h2\", { staticClass: \"heading heading_h2 mb_9\" }, [\n          _vm._v(\"Необходимо ввести email\")\n        ]),\n        _vm._v(\" \"),\n        _c(\"div\", { staticClass: \"lm-input-wrap\" }, [\n          _c(\"input\", {\n            directives: [\n              {\n                name: \"validate\",\n                rawName: \"v-validate\",\n                value: \"required|email\",\n                expression: \"'required|email'\"\n              },\n              {\n                name: \"model\",\n                rawName: \"v-model\",\n                value: _vm.fields.email,\n                expression: \"fields.email\"\n              }\n            ],\n            class: [\n              { error: _vm.verrors.has(\"email\"), ok: _vm.isValidEmail },\n              \"lm-input\"\n            ],\n            attrs: {\n              type: \"email\",\n              tabindex: \"1\",\n              name: \"email\",\n              autocapitalize: \"off\",\n              placeholder: \"E-mail\"\n            },\n            domProps: { value: _vm.fields.email },\n            on: {\n              input: function($event) {\n                if ($event.target.composing) {\n                  return\n                }\n                _vm.$set(_vm.fields, \"email\", $event.target.value)\n              }\n            }\n          }),\n          _vm._v(\" \"),\n          _vm.verrors.has(\"email\")\n            ? _c(\"span\", { staticClass: \"lm-input-error\" }, [\n                _vm._v(_vm._s(_vm.verrors.first(\"email\")))\n              ])\n            : _vm._e()\n        ]),\n        _vm._v(\" \"),\n        _c(\"div\", [\n          _c(\n            \"button\",\n            {\n              class: [\n                \"lm-primary-button\",\n                { disabled: this.verrors.any() || !_vm.fields.email }\n              ],\n              attrs: { href: \"javascript:void(0)\" },\n              on: { click: _vm.saveEmail }\n            },\n            [_vm._v(\"Продолжить\\n        \")]\n          )\n        ])\n      ]),\n      _vm._v(\" \"),\n      _c(\"div\")\n    ])\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n    require(\"vue-hot-reload-api\")      .rerender(\"data-v-25f5c3e8\", esExports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ../node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-25f5c3e8\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../node_modules/vue-loader/lib/selector.js?type=template&index=0!../src/views/User/EmptyEmail/Index.vue\n// module id = 2502\n// module chunks = 218\n\n\n// WEBPACK FOOTER //\n// webpack:///../src/views/User/EmptyEmail/Index.vue?507b"],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAJA;AAQA;AACA;AAAA;AAEA;AADA;AAGA;AACA;AACA;AANA;AAQA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AAVA;AACA;AACA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AATA;AAAA;AACA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AAJA;AACA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AALA;AACA;AACA;AASA;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AACA;AAIA;AACA;AATA;AAAA;AACA;AACA;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AA5FA;AAtBA;;;;;;;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}